# üîç –†–µ–∂–∏–º—ã –ø–æ–∏—Å–∫–∞ —Ä–µ–∑—é–º–µ

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **3 —Ä–µ–∂–∏–º–∞ –ø–æ–∏—Å–∫–∞** –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞.

## üéØ –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–µ–∂–∏–º—ã

### 1. Dense-only (Voyage AI) üåä
- **–ß—Ç–æ:** –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ embeddings —á–µ—Ä–µ–∑ Voyage AI
- **–†–∞–∑–º–µ—Ä:** 1024 –∏–∑–º–µ—Ä–µ–Ω–∏—è
- **–ü–æ–Ω–∏–º–∞–µ—Ç:** –°–∏–Ω–æ–Ω–∏–º—ã, –ø–æ—Ö–æ–∂–∏–µ –∫–æ–Ω—Ü–µ–ø—Ç—ã
- **–ü—Ä–∏–º–µ—Ä:** "Python developer" ‚âà "Python engineer"

### 2. Sparse-only (TF-IDF) üìä
- **–ß—Ç–æ:** –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –≤–µ—Å–∞ —Å–ª–æ–≤ (TF-IDF)
- **–†–∞–∑–º–µ—Ä:** ~100-500 –Ω–µ–Ω—É–ª–µ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **–ü–æ–Ω–∏–º–∞–µ—Ç:** –¢–æ—á–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å–ª–æ–≤
- **–ü—Ä–∏–º–µ—Ä:** "FastAPI" = "FastAPI" (–Ω–µ –ø—É—Ç–∞–µ—Ç —Å "Flask")

### 3. Hybrid (Dense + Sparse) ‚ö°
- **–ß—Ç–æ:** –ö–æ–º–±–∏–Ω–∞—Ü–∏—è –æ–±–æ–∏—Ö —á–µ—Ä–µ–∑ RRF fusion
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** –°–µ–º–∞–Ω—Ç–∏–∫–∞ + —Ç–æ—á–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã
- **–õ—É—á—à–∏–π –∏–∑ –¥–≤—É—Ö –º–∏—Ä–æ–≤!**

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### –û—Ü–µ–Ω–∫–∞ —Å –æ–¥–Ω–∏–º —Ä–µ–∂–∏–º–æ–º

```bash
# Dense-only
python app/run_evaluation.py --dense

# Sparse-only (—Ç–æ–ª—å–∫–æ TF-IDF)
python app/run_evaluation.py --sparse

# Hybrid (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
python app/run_evaluation.py --hybrid
# –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ
python app/run_evaluation.py
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤

```bash
python app/compare_search_modes.py
```

–≠—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç –≤—Å–µ 3 —Ä–µ–∂–∏–º–∞ –∏ –ø–æ–∫–∞–∂–µ—Ç:
- –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ
- –ü—Ä–æ—Ü–µ–Ω—Ç —É–ª—É—á—à–µ–Ω–∏—è
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é –∫–∞–∫–æ–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | Dense | Sparse (TF-IDF) | Hybrid |
|----------------|-------|-----------------|--------|
| **–°–µ–º–∞–Ω—Ç–∏–∫–∞** | ‚úÖ –û—Ç–ª–∏—á–Ω–æ | ‚ùå –ù–µ—Ç | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| **–¢–æ—á–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã** | ‚ö†Ô∏è –ú–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å | ‚úÖ –û—Ç–ª–∏—á–Ω–æ | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| **–°–∫–æ—Ä–æ—Å—Ç—å –ø–æ–∏—Å–∫–∞** | üü¢ –ë—ã—Å—Ç—Ä–æ (~10ms) | üü¢ –ë—ã—Å—Ç—Ä–æ (~5ms) | üü° –°—Ä–µ–¥–Ω–µ (~15ms) |
| **–ù—É–∂–Ω–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞** | ‚ùå –ù–µ—Ç | ‚úÖ –û–±—É—á–∏—Ç—å TF-IDF | ‚úÖ –û–±—É—á–∏—Ç—å TF-IDF |
| **–ö–∞—á–µ—Å—Ç–≤–æ** | üü° –•–æ—Ä–æ—à–æ | üü° –•–æ—Ä–æ—à–æ | üü¢ –õ—É—á—à–µ–µ |

## üéì –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π —Ä–µ–∂–∏–º

### Dense-only ‚úÖ

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ—Å–ª–∏:**
- –í–∞–∂–Ω–∞ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –ø–æ—Ö–æ–∂–µ—Å—Ç—å
- –ù–µ—Ç –æ–±—É—á–µ–Ω–Ω–æ–π TF-IDF –º–æ–¥–µ–ª–∏
- –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ
- –°–∏–Ω–æ–Ω–∏–º—ã –∏ –≤–∞—Ä–∏–∞—Ü–∏–∏ —Ç–µ—Ä–º–∏–Ω–æ–≤

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```
"–ò—â—É —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å –æ–ø—ã—Ç–æ–º –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ Python"
‚Üí –ù–∞–π–¥–µ—Ç: "Python web developer", "Backend Python engineer"
```

### Sparse-only (TF-IDF) ‚úÖ

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ—Å–ª–∏:**
- –í–∞–∂–Ω—ã —Ç–æ—á–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤
- Keyword-based –∑–∞–ø—Ä–æ—Å—ã
- –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏
- –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –ø–æ —Ç–µ—Ä–º–∏–Ω–∞–º

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```
"FastAPI PostgreSQL Docker Kubernetes"
‚Üí –ù–∞–π–¥–µ—Ç —Ç–æ—á–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —ç—Ç–∏—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
```

### Hybrid ‚úÖ‚úÖ‚úÖ

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ—Å–ª–∏ (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø):**
- –ù—É–∂–Ω–æ –ª—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ
- –í–∞–∂–Ω—ã –∏ —Å–µ–º–∞–Ω—Ç–∏–∫–∞, –∏ —Ç–æ—á–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã
- –ï—Å—Ç—å –æ–±—É—á–µ–Ω–Ω–∞—è TF-IDF –º–æ–¥–µ–ª—å
- –ì–æ—Ç–æ–≤—ã –∫ –Ω–µ–±–æ–ª—å—à–æ–º—É overhead (~5ms)

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```
"Backend developer with FastAPI and database experience"
‚Üí –°–µ–º–∞–Ω—Ç–∏–∫–∞: "backend", "developer", "database"
‚Üí –¢–æ—á–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã: "FastAPI"
‚Üí –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç!
```

## üìà –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –ø–æ–∑–∏—Ü–∏–π (Backend, AI engineer)

**Dense-only:**
- MAP: 0.65-0.75
- Precision@5: 0.6-0.7

**Sparse-only:**
- MAP: 0.70-0.80
- Precision@5: 0.7-0.8

**Hybrid:**
- MAP: 0.80-0.95 ‚≠ê
- Precision@5: 0.8-1.0 ‚≠ê

**–£–ª—É—á—à–µ–Ω–∏–µ:** +15-25% –æ—Ç hybrid!

### –î–ª—è –æ–±—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π (QA, Frontend)

–í—Å–µ —Ä–µ–∂–∏–º—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø–æ—Ö–æ–∂–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (~5% —Ä–∞–∑–Ω–∏—Ü–∞).

## üí° –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç

```bash
# –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—Å–µ —Ä–µ–∂–∏–º—ã
python app/run_evaluation.py --dense
python app/run_evaluation.py --sparse
python app/run_evaluation.py --hybrid

# –°—Ä–∞–≤–Ω–∏—Ç–µ MAP –≤ –≤—ã–≤–æ–¥–µ
```

### –ü—Ä–∏–º–µ—Ä 2: –ò–∑ –∫–æ–¥–∞

```python
from service.parse_pdf import CVParser
from evaluate_search import CVSearchEvaluator

parser = CVParser(collection_name="CVs")
evaluator = CVSearchEvaluator(parser)

# –¢–µ—Å—Ç –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤
for mode in ["dense", "sparse", "hybrid"]:
    df, results = evaluator.evaluate_all(top_k=10, search_mode=mode)
    print(f"{mode}: MAP = {df['map'].mean():.3f}")
```

### –ü—Ä–∏–º–µ—Ä 3: –ü–æ–∏—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–∞–∫–∞–Ω—Å–∏–∏

```python
# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–∞–∫–∞–Ω—Å–∏–∏
vacancy = "Backend_1"

for mode in ["dense", "sparse", "hybrid"]:
    result = evaluator.evaluate_single_vacancy(
        vacancy,
        top_k=10,
        search_mode=mode
    )
    print(f"{mode}: MAP = {result['metrics']['map']:.3f}")
```

## üîß –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Ç–æ–Ω–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –í–µ—Å–∞ –¥–ª—è Hybrid (–≤ –±—É–¥—É—â–µ–º)

–ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç dense vs sparse:

```python
# –ë–æ–ª—å—à–µ –≤–µ—Å–∞ –Ω–∞ dense (—Å–µ–º–∞–Ω—Ç–∏–∫—É)
dense_weight = 0.7
sparse_weight = 0.3

# –ë–∞–ª–∞–Ω—Å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ RRF)
dense_weight = 0.5
sparse_weight = 0.5

# –ë–æ–ª—å—à–µ –≤–µ—Å–∞ –Ω–∞ sparse (—Ç–æ—á–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã)
dense_weight = 0.3
sparse_weight = 0.7
```

### TF-IDF –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–í–ª–∏—è—é—Ç –Ω–∞ Sparse –∏ Hybrid —Ä–µ–∂–∏–º—ã:

```python
parser.sparse_model = TfidfVectorizer(
    max_features=15000,    # –ë–æ–ª—å—à–µ —Å–ª–æ–≤
    ngram_range=(1, 3),    # –¢—Ä–∏–≥—Ä–∞–º–º—ã –¥–ª—è —Ñ—Ä–∞–∑
    min_df=2              # –ú–∏–Ω–∏–º—É–º –≤ 2 –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö
)
```

## üìä –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

```
–ú–µ—Ç—Ä–∏–∫–∞      Dense   Sparse (TF-IDF)  Sparse vs Dense  Hybrid   Hybrid vs Dense
MAP          0.844   0.912            +8.1%            0.957    +13.4%
PRECISION@5  0.760   0.840            +10.5%           0.920    +21.1%
RECALL@10    0.960   0.980            +2.1%            1.000    +4.2%
MRR          0.920   0.960            +4.3%            0.980    +6.5%

–õ–£–ß–®–ò–ô –†–ï–ñ–ò–ú: Hybrid (MAP: 0.957)
```

## üÜò Troubleshooting

### "TF-IDF –Ω–µ –æ–±—É—á–µ–Ω"

**–ü—Ä–∏—á–∏–Ω–∞:** –ú–æ–¥–µ–ª—å –Ω–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –∏–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ
ls data/models/tfidf_CVs.pkl

# –ï—Å–ª–∏ –Ω–µ—Ç, –∑–∞–≥—Ä—É–∑–∏—Ç–µ CV
python app/load_txt_to_qdrant.py
```

### Sparse —Ä–µ–∂–∏–º –¥–∞–µ—Ç –æ—à–∏–±–∫—É

**–ü—Ä–∏—á–∏–Ω–∞:** Vocabulary –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–æ–≤–∞ –∏–∑ query

**–†–µ—à–µ–Ω–∏–µ:**
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ TF-IDF –æ–±—É—á–µ–Ω –Ω–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–º –∫–æ—Ä–ø—É—Å–µ (> 10 CV)
- –£–≤–µ–ª–∏—á—å—Ç–µ `max_features` –≤ TF-IDF

### –í—Å–µ —Ä–µ–∂–∏–º—ã –¥–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–ü—Ä–∏—á–∏–Ω–∞:** 
- –ö–æ—Ä–ø—É—Å —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–π (< 5 CV)
- –ò–ª–∏ –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ CV
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –≤–∞–∫–∞–Ω—Å–∏–∏

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –î–ª—è –≤–∞—à–µ–≥–æ —Å–ª—É—á–∞—è (5 –≤–∞–∫–∞–Ω—Å–∏–π, 25 CV):

1. ‚úÖ **–ó–∞–≥—Ä—É–∑–∏—Ç–µ CV** (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã):
   ```bash
   python app/load_txt_to_qdrant.py
   ```

2. ‚úÖ **–°—Ä–∞–≤–Ω–∏—Ç–µ –≤—Å–µ —Ä–µ–∂–∏–º—ã**:
   ```bash
   python app/compare_search_modes.py
   ```

3. ‚úÖ **–í—ã–±–µ—Ä–∏—Ç–µ –ª—É—á—à–∏–π —Ä–µ–∂–∏–º** –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç—Ä–∏–∫

4. ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ** –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º

### –û–±—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

- **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø–æ–∑–∏—Ü–∏–∏** ‚Üí Hybrid (—Ç–æ—á–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã –≤–∞–∂–Ω—ã)
- **–û–±—â–∏–µ –ø–æ–∑–∏—Ü–∏–∏** ‚Üí Dense –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
- **Keyword –ø–æ–∏—Å–∫** ‚Üí Sparse
- **–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —è–∑—ã–∫** ‚Üí Dense –∏–ª–∏ Hybrid

## üìö –°–º. —Ç–∞–∫–∂–µ

- `app/HYBRID_SEARCH_GUIDE.md` - –î–µ—Ç–∞–ª–∏ hybrid search
- `app/TFIDF_PERSISTENCE.md` - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ TF-IDF –º–æ–¥–µ–ª–∏
- `app/EVALUATION_GUIDE.md` - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –æ—Ü–µ–Ω–∫–µ

---

**–ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å —É –≤–∞—Å 3 —Ä–µ–∂–∏–º–∞ –ø–æ–∏—Å–∫–∞ –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤! üéâ**

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ:
python app/compare_search_modes.py
```
